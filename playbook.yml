---
- name: Nginx installation and configuration
  hosts: web
  become: true
  gather_facts: true

  tasks:
    - name: Install Nginx
      yum:
        name: nginx
        state: present

    - name: Ensure Nginx is running and enabled
      service:
        name: nginx
        state: started
        enabled: true


- name: Java and Maven installation and configuration
  hosts: app
  become: true
  gather_facts: true

  tasks:
    - name: Install Java 17
      yum:
        name: java-17-amazon-corretto
        state: present

    - name: Install Maven
      yum:
        name: maven
        state: present

    - name: Verify Java installation
      command: java -version
      register: java_version
      changed_when: false

    - name: Show installed Java version
      debug:
        msg: "{{ java_version.stdout }}"

    - name: Verify Maven installation
      command: mvn -version
      register: maven_version
      changed_when: false

    - name: Show installed Maven version
      debug:
        msg: "{{ maven_version.stdout }}"